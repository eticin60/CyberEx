<!DOCTYPE html>
<html lang="tr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberEx - Hesabım</title>
    <link rel="icon" type="image/png" href="assets/images/logo.png">

    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/account.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>

<body class="dashboard-page">

    <!-- Background Animation Layer (Synced with Index) -->
    <div class="bg-animated">
        <div class="circuit-board"></div>
        <div class="circuit-nodes" id="circuitNodes"></div>
        <div class="orb orb-1"></div>
        <div class="orb orb-2"></div>
        <div class="orb orb-3"></div>
        <canvas id="particles-canvas"></canvas>
        <canvas id="network-canvas"></canvas>
    </div>

    <!-- Top Contact Bar (Unified with Index) -->
    <div class="top-contact-bar" style="justify-content: space-between; padding: 0 20px;">
        <!-- Left Side: Contact Info -->
        <div class="contact-info-left" style="display: flex; gap: 20px; align-items: center;">
            <a href="index.html" style="text-decoration: none; color: inherit;"><i class="fas fa-home"></i> Ana
                Sayfa</a>
            <div class="live-activity-box">
                <div class="live-dot"></div>
                <span id="liveTxCount">LIVE: 1,842 TX/S</span>
            </div>
            <a href="#" class="system-status-pill">SİSTEM: AKTİF</a>
        </div>

    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <a href="index.html" class="nav-logo-center">
            <img src="cyberex-logo.png" alt="CyberEx Logo" style="height: 40px;">
            <div class="nav-tagline">AI POWERED FINTECH</div>
        </a>

        <div class="nav-links">
            <a href="#" class="nav-link disabled-link" onclick="return false;">PİYASALAR <span
                    class="nav-badge-soon">YAKINDA</span></a>
            <a href="#" class="nav-link disabled-link" onclick="return false;">CÜZDAN <span
                    class="nav-badge-soon">YAKINDA</span></a>

            <!-- Account page usually doesn't need 'Download App' in center if logged in, but we act consistent with index's center logic which home-nav.js hides if logged in -->
            <a href="download.html" class="nav-btn-filled" id="navDownloadBtn"
                style="margin: 0 15px; background: #00f0ff; color: #000; padding: 12px 28px; border-radius: 50px; font-weight: 900; font-size: 1rem; box-shadow: 0 0 25px rgba(0, 240, 255, 0.5); text-transform: uppercase;"
                data-tr="UYGULAMA İNDİR" data-en="DOWNLOAD APP">UYGULAMA İNDİR</a>

            <a href="#" class="nav-link disabled-link" onclick="return false;">EKOSİSTEM <span
                    class="nav-badge-soon">YAKINDA</span></a>
            <a href="#" class="nav-link disabled-link" onclick="return false;">DESTEK <span
                    class="nav-badge-soon">YAKINDA</span></a>
        </div>
        </div>

        <!-- Auth/Profile Section -->
        <div class="nav-right-group" id="userNav"
            style="display: flex; align-items: center; margin-left: auto; margin-right: 20px;">
            <!-- Auth buttons will be injected here -->
        </div>

        <!-- Language Switcher (Added for consistency) -->
        <div class="lang-switcher">
            <button class="lang-btn active" data-lang="tr">TR</button>
            <button class="lang-btn" data-lang="en">EN</button>
        </div>

        <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
            <i class="fas fa-bars"></i>
        </button>
    </nav>

    <main class="dashboard-content">
        <div class="container">
            <!-- Security Warning Banner (Hidden by default) -->
            <div id="securityBanner" class="security-alert" style="display: none;">
                <i class="fas fa-exclamation-triangle"></i>
                <div class="alert-content">
                    <h4>Çekim İşlemleri Kısıtlandı</h4>
                    <p id="securityReason">Güvenlik değişikliği nedeniyle 48 saat boyunca çekim yapamazsınız.</p>
                    <span id="securityTimer" class="timer">Kalan Süre: --:--</span>
                </div>
            </div>

            <!-- Top Section: Profile Header -->
            <section class="profile-header-card reveal">
                <div class="profile-main-info">
                    <div class="avatar-large-container">
                        <div class="avatar-large" id="mainAvatar">
                            <i class="fas fa-user-shield"></i>
                        </div>
                        <button class="edit-avatar-btn" onclick="openAvatarModal()">
                            <i class="fas fa-camera"></i>
                        </button>
                    </div>
                    <div class="profile-text">
                        <h1 id="displayName">Kullanıcı Adı</h1>
                        <p id="displayEmail">email@example.com</p>
                        <div class="badges" id="badgeContainer">
                            <!-- Badges will be injected here -->
                        </div>
                    </div>
                </div>

                <div class="profile-stats">
                    <div class="stat-item">
                        <span class="label">Cyber ID</span>
                        <div class="id-copy" onclick="copyCyberId()">
                            <span id="cyberId">---------</span>
                            <i class="far fa-copy"></i>
                        </div>
                    </div>
                    <div class="stat-item">
                        <span class="label">VIP Seviyesi</span>
                        <span class="value" id="vipLevel">Lvl 1</span>
                    </div>
                    <div class="stat-item">
                        <span class="label">KYC Durumu</span>
                        <span class="status-badge" id="kycStatus">Doğrulanmadı</span>
                    </div>
                </div>
            </section>

            <div class="dashboard-grid">
                <!-- Left Column: Wallet & Positions -->
                <div class="grid-left">
                    <!-- Wallet Card -->
                    <section class="glass-card wallet-card reveal" id="wallet">
                        <div class="card-header">
                            <h2><i class="fas fa-wallet"></i> Cüzdan Özeti</h2>
                            <a href="#" class="view-all">Tümü <i class="fas fa-arrow-right"></i></a>
                        </div>
                        <div class="balance-display">
                            <span class="label">Toplam Varlık (USDT)</span>
                            <div class="amount-row">
                                <span class="currency">$</span>
                                <span class="amount" id="totalBalance">0.00</span>
                            </div>
                            <div class="balance-split">
                                <div class="split-item">
                                    <span>Spot</span>
                                    <strong id="spotBalance">$0.00</strong>
                                </div>
                                <div class="split-item">
                                    <span>Futures</span>
                                    <strong id="futuresBalance">$0.00</strong>
                                </div>
                            </div>
                        </div>
                        <div class="pnl-summary" id="pnlSummary">
                            <span>Günlük Kar/Zarar</span>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span class="pnl-value" id="dailyPnl">+$0.00 (0.00%)</span>
                                <button class="btn-icon-sm" onclick="sharePnl()" title="PNL Paylaş">
                                    <i class="fas fa-share-alt"></i>
                                </button>
                            </div>
                        </div>
                    </section>

                    <!-- Positions Card -->
                    <section class="glass-card positions-card reveal">
                        <div class="card-header">
                            <h2><i class="fas fa-chart-line"></i> Açık Pozisyonlar</h2>
                            <span class="count-badge" id="positionCount">0</span>
                        </div>
                        <div class="positions-list" id="positionsContainer">
                            <div class="empty-state">
                                <i class="fas fa-stream"></i>
                                <p>Açık pozisyon bulunamadı</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Right Column: Messages & Quick Settings -->
                <div class="grid-right">
                    <!-- Notifications Card -->
                    <section class="glass-card messages-card reveal" id="messages">
                        <div class="card-header">
                            <h2><i class="fas fa-bell"></i> Bildirimler</h2>
                        </div>
                        <div class="notifications-list" id="notificationsContainer">
                            <!-- Notifications will be injected here -->
                        </div>
                    </section>

                    <!-- Settings & Security Card -->
                    <section class="glass-card settings-card reveal" id="settings">
                        <div class="card-header">
                            <h2><i class="fas fa-user-shield"></i> Güvenlik & Ayarlar</h2>
                        </div>

                        <form id="settingsForm" class="settings-form">
                            <!-- Phone Number -->
                            <div class="form-group">
                                <label>Telefon Numarası</label>
                                <div class="input-wrapper">
                                    <i class="fas fa-phone"></i>
                                    <input type="tel" id="phoneInput" placeholder="+90 555 000 0000" readonly>
                                    <button type="button" class="btn-icon" onclick="togglePhoneEdit()"
                                        title="Değiştir (48s Kısıtlama)">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                                <small class="info-text"><i class="fas fa-info-circle"></i> Değişiklik sonrası 48 saat
                                    çekim kısıtlaması uygulanır.</small>
                            </div>

                            <!-- Password Change -->
                            <div class="form-group">
                                <label>Yeni Şifre</label>
                                <div class="input-wrapper">
                                    <i class="fas fa-lock"></i>
                                    <button type="submit" class="btn btn-primary full-width">
                                        <i class="fas fa-save"></i> Değişiklikleri Kaydet
                                    </button>
                        </form>
                    </section>
                </div>
            </div>
        </div>
    </main>

    <!-- Reference System Modal -->
    <div id="referenceModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="document.getElementById('referenceModal').style.display='none'"
                style="float: right; cursor: pointer; font-size: 28px;">&times;</span>
            <h2 style="color: var(--neon-cyan); margin-top: 0;">Referans İstatistikleri</h2>

            <div class="ref-stats-grid"
                style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div class="stat-card"
                    style="background: rgba(0, 240, 255, 0.05); padding: 15px; border-radius: 8px; text-align: center;">
                    <h3 style="font-size: 0.9rem; color: #888;">Toplam Referans</h3>
                    <span id="totalRefs" class="highlight-neon"
                        style="font-size: 1.5rem; font-weight: bold; color: #fff;">0</span>
                </div>
                <div class="stat-card"
                    style="background: rgba(0, 240, 255, 0.05); padding: 15px; border-radius: 8px; text-align: center;">
                    <h3 style="font-size: 0.9rem; color: #888;">Komisyon Oranı</h3>
                    <span id="commissionRate" class="highlight-neon"
                        style="font-size: 1.5rem; font-weight: bold; color: #fff;">%10</span>
                </div>
            </div>

            <div class="ref-link-box">
                <label style="display: block; margin-bottom: 8px; color: #ccc;">Referans Bağlantınız:</label>
                <div class="input-wrapper" style="position: relative;">
                    <input type="text" id="refLink" readonly onclick="this.select(); document.execCommand('copy');"
                        style="width: 100%; padding: 10px; background: #000; border: 1px solid #333; color: #00ff88; border-radius: 5px;">
                    <i class="fas fa-copy"
                        style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); color: #888;"></i>
                </div>
                <small style="color: #666; margin-top: 5px; display: block;">Kopyalamak için tıklayın</small>
            </div>
        </div>
    </div>

    <!-- Modal: Position Close Confirmation -->
    <div id="closeModal" class="modal">
        <div class="modal-content">
            <h3><i class="fas fa-exclamation-triangle"></i> Acil Pozisyon Kapatma</h3>
            <p>Bu pozisyonu piyasa fiyatından kapatmak istediğinize emin misiniz?</p>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">İptal</button>
                <button class="btn btn-danger" id="confirmCloseBtn">Evet, Kapat</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="assets/js/firebase-config.js"></script>
    <script src="assets/js/auth.js"></script>
    <script src="assets/js/home-nav.js"></script>
    <script src="assets/js/account.js"></script>
</body>

</html>